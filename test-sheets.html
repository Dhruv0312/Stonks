<!DOCTYPE html>
<html>
<head>
    <title>Google Sheets Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .error { color: red; background: #ffe6e6; padding: 10px; border-radius: 5px; }
        .success { color: green; background: #e6ffe6; padding: 10px; border-radius: 5px; }
        .info { background: #e6f3ff; padding: 10px; border-radius: 5px; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Google Sheets API Test</h1>
    <div id="results"></div>
    
    <div style="margin: 20px 0;">
        <button onclick="testSheet('Watchlist')">Test Watchlist Sheet</button>
        <button onclick="testSheet('Stock Data')">Test Stock Data Sheet</button>
        <button onclick="testSheet('Sheet1')">Test Sheet1</button>
        <button onclick="testSheet('Sheet2')">Test Sheet2</button>
    </div>
    
    <script>
        const API_KEY = 'AIzaSyBANy06jI96BJZYS5PBhrhK3bhoNsfWwZ0';
        const SPREADSHEET_ID = '10F2ON8N3phmbvKQNQFfKet44XoytFxA3SgUiIlHl6VY';
        
        async function testSheet(sheetName) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `<div class="info">Testing sheet: <strong>${sheetName}</strong></div>`;
            
            try {
                const response = await fetch(
                    `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${encodeURIComponent(sheetName)}!A:Z?key=${API_KEY}`
                );
                
                resultsDiv.innerHTML += `<p><strong>Response Status:</strong> ${response.status}</p>`;
                
                if (!response.ok) {
                    const errorText = await response.text();
                    resultsDiv.innerHTML += `<div class="error">
                        <strong>Error ${response.status}:</strong> ${errorText}
                        <br><br>
                        <strong>Possible Solutions:</strong>
                        <ul>
                            <li>Make sure the sheet "${sheetName}" exists</li>
                            <li>Make sure the sheet is shared publicly (Anyone with link can view)</li>
                            <li>Check if the API key has the right permissions</li>
                        </ul>
                    </div>`;
                    return;
                }
                
                const data = await response.json();
                resultsDiv.innerHTML += `<div class="success">
                    <strong>Success!</strong> Data received from "${sheetName}"
                    <br><strong>Total Rows:</strong> ${data.values ? data.values.length : 0}
                    <br><strong>Data Rows (excluding header):</strong> ${data.values ? data.values.length - 1 : 0}
                </div>`;
                
                if (data.values && data.values.length > 0) {
                    resultsDiv.innerHTML += `<h3>First 5 Rows from "${sheetName}":</h3>`;
                    data.values.slice(0, 5).forEach((row, index) => {
                        resultsDiv.innerHTML += `<p><strong>Row ${index + 1}:</strong> ${JSON.stringify(row)}</p>`;
                    });
                }
                
            } catch (error) {
                resultsDiv.innerHTML += `<div class="error">
                    <strong>Network Error:</strong> ${error.message}
                    <br><br>
                    <strong>Possible Solutions:</strong>
                    <ul>
                        <li>Check your internet connection</li>
                        <li>Make sure the spreadsheet ID is correct</li>
                        <li>Verify the API key is valid</li>
                    </ul>
                </div>`;
            }
        }
        
        // Test Watchlist by default
        testSheet('Watchlist');
    </script>
</body>
</html> 